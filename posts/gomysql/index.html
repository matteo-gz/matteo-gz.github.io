<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>golang-mysql包 - matteo's blog</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://matteo-gz.github.io/posts/gomysql/">
<meta property="og:site_name" content="matteo's blog"><meta property="og:title" content="golang-mysql包"><meta property="og:description" content="golang原生的mysql包是https://github.com/go-sql-driver/mysql
其中DSN (Data Source Name)格式username:password@protocol(address)/dbname?param=value
字段 介绍 username 数据库账号名 password 数据库密码 protocol 协议,tcp, address 数据库host地址 dbname 数据库名,此项为可选项 param 参数支持多个,且区分大小写 参数 默认 介绍 allowAllFiles false allowCleartextPasswords false allowNativePasswords true allowOldPasswords false charset 常用,字符集 checkConnLiveness true collation utf8mb4_general_ci clientFoundRows false columnsWithAlias false interpolateParams false loc UTC 常用,时区 maxAllowedPacket 4194304 multiStatements false parseTime false readTimeout 0 执行读开始计算时间,超过则中断 rejectReadOnly false serverPubKey none timeout OS default tls false writeTimeout 0 其他参数的填写则设置为系统变量,string要用单引号圈起来且url.QueryEscape处理"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-02T10:30:09+08:00"><meta property="article:modified_time" content="2022-09-02T10:30:09+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="golang-mysql包"><meta name=twitter:description content="golang原生的mysql包是https://github.com/go-sql-driver/mysql
其中DSN (Data Source Name)格式username:password@protocol(address)/dbname?param=value
字段 介绍 username 数据库账号名 password 数据库密码 protocol 协议,tcp, address 数据库host地址 dbname 数据库名,此项为可选项 param 参数支持多个,且区分大小写 参数 默认 介绍 allowAllFiles false allowCleartextPasswords false allowNativePasswords true allowOldPasswords false charset 常用,字符集 checkConnLiveness true collation utf8mb4_general_ci clientFoundRows false columnsWithAlias false interpolateParams false loc UTC 常用,时区 maxAllowedPacket 4194304 multiStatements false parseTime false readTimeout 0 执行读开始计算时间,超过则中断 rejectReadOnly false serverPubKey none timeout OS default tls false writeTimeout 0 其他参数的填写则设置为系统变量,string要用单引号圈起来且url.QueryEscape处理"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=referrer content="no-referrer"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://matteo-gz.github.io/posts/gomysql/><link rel=prev href=https://matteo-gz.github.io/posts/scalablegoschedulerdesigndoc/><link rel=next href=https://matteo-gz.github.io/posts/asm/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"golang-mysql包","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/matteo-gz.github.io\/posts\/gomysql\/"},"genre":"posts","wordcount":83,"url":"https:\/\/matteo-gz.github.io\/posts\/gomysql\/","datePublished":"2022-09-02T10:30:09+08:00","dateModified":"2022-09-02T10:30:09+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"xxxx"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>const query=window.matchMedia("(prefers-color-scheme: dark)");function applyTheme(){let e=window.localStorage?.getItem("theme")||"auto",t=e==="dark"||e==="auto"&&query.matches;document.body.setAttribute("theme",t?"dark":"light"),document.body.setAttribute("cfg-theme",e)}applyTheme(),query.addEventListener("change",applyTheme)</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="matteo's blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/Logo_Matteo-100-360x135px.png data-srcset="/images/Logo_Matteo-100-360x135px.png, /images/Logo_Matteo-100-360x135px.png 1.5x, /images/Logo_Matteo-100-360x135px.png 2x" data-sizes=auto alt=/images/Logo_Matteo-100-360x135px.png title=/images/Logo_Matteo-100-360x135px.png>'s blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=/links/>Bookmarks </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="matteo's blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/Logo_Matteo-100-360x135px.png data-srcset="/images/Logo_Matteo-100-360x135px.png, /images/Logo_Matteo-100-360x135px.png 1.5x, /images/Logo_Matteo-100-360x135px.png 2x" data-sizes=auto alt=/images/Logo_Matteo-100-360x135px.png title=/images/Logo_Matteo-100-360x135px.png>'s blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/links/ title>Bookmarks</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">golang-mysql包</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>xxxx</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-09-02>2022-09-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;83 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;One minute&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li></li><li><a href=#mysql配置>mysql配置</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>golang原生的mysql包是https://github.com/go-sql-driver/mysql</p><p>其中DSN (Data Source Name)格式<code>username:password@protocol(address)/dbname?param=value</code></p><table><thead><tr><th>字段</th><th>介绍</th></tr></thead><tbody><tr><td>username</td><td>数据库账号名</td></tr><tr><td>password</td><td>数据库密码</td></tr><tr><td>protocol</td><td>协议,tcp,</td></tr><tr><td>address</td><td>数据库host地址</td></tr><tr><td>dbname</td><td>数据库名,此项为可选项</td></tr><tr><td>param</td><td>参数支持多个,且区分大小写</td></tr></tbody></table><table><thead><tr><th>参数</th><th>默认</th><th>介绍</th></tr></thead><tbody><tr><td>allowAllFiles</td><td>false</td><td></td></tr><tr><td>allowCleartextPasswords</td><td>false</td><td></td></tr><tr><td>allowNativePasswords</td><td>true</td><td></td></tr><tr><td>allowOldPasswords</td><td>false</td><td></td></tr><tr><td>charset</td><td></td><td>常用,字符集</td></tr><tr><td>checkConnLiveness</td><td>true</td><td></td></tr><tr><td>collation</td><td>utf8mb4_general_ci</td><td></td></tr><tr><td>clientFoundRows</td><td>false</td><td></td></tr><tr><td>columnsWithAlias</td><td>false</td><td></td></tr><tr><td>interpolateParams</td><td>false</td><td></td></tr><tr><td>loc</td><td>UTC</td><td>常用,时区</td></tr><tr><td>maxAllowedPacket</td><td>4194304</td><td></td></tr><tr><td>multiStatements</td><td>false</td><td></td></tr><tr><td>parseTime</td><td>false</td><td></td></tr><tr><td>readTimeout</td><td>0</td><td>执行读开始计算时间,超过则中断</td></tr><tr><td>rejectReadOnly</td><td>false</td><td></td></tr><tr><td>serverPubKey</td><td>none</td><td></td></tr><tr><td>timeout</td><td>OS default</td><td></td></tr><tr><td>tls</td><td>false</td><td></td></tr><tr><td>writeTimeout</td><td>0</td><td></td></tr></tbody></table><p>其他参数的填写则设置为系统变量,string要用单引号圈起来且url.QueryEscape处理</p><h4 id=设置函数>设置函数</h4><p>SetMaxOpenConns 为最大连接数</p><p>SetMaxIdleConns 为最大空闲数,SetMaxIdleConns&lt;=SetMaxOpenConns,一般不推荐用</p><p>SetConnMaxLifetime 为最大空闲时间,一般小于mysql系统的wait_timeout</p><h3 id=mysql配置>mysql配置</h3><p>查询慢日志相关</p><ul><li>slow_query_log 是否开启了慢日志</li><li>long_query_time 超过多少s开始记录</li><li>slow_query_log_file 慢日志位置</li></ul><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-sql"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>@@</span><span class=k>global</span><span class=p>.</span><span class=n>slow_query_log</span><span class=p>,</span><span class=o>@@</span><span class=k>global</span><span class=p>.</span><span class=n>long_query_time</span><span class=p>,</span><span class=o>@@</span><span class=k>global</span><span class=p>.</span><span class=n>slow_query_log_file</span></span></span></code></pre></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-09-02</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on X" data-sharer=x data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包><i class="fab fa-x-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Threads" data-sharer=threads data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包><i class="fab fa-threads fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://matteo-gz.github.io/posts/gomysql/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@14.9.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Diaspora" data-sharer=diaspora data-url=https://matteo-gz.github.io/posts/gomysql/ data-title=golang-mysql包 data-description><i class="fab fa-diaspora fa-fw" aria-hidden=true></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fmatteo-gz.github.io%2fposts%2fgomysql%2f&amp;text=golang-mysql%e5%8c%85" target=_blank title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/scalablegoschedulerdesigndoc/ class=prev rel=prev title="Scalable Go Scheduler Design Doc 中文翻译"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Scalable Go Scheduler Design Doc 中文翻译</a>
<a href=/posts/asm/ class=next rel=next title=汇编学习>汇编学习<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>xxxx</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script src=https://https-matteo-gz-github-io.disqus.com/embed.js defer></script><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script src=https://cdn.jsdelivr.net/npm/algoliasearch@5.20.2/dist/lite/builds/browser.umd.min.js></script><script src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/copy-tex.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/mhchem.min.js></script><script>window.config={comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"I3HV4LCBLW",algoliaIndex:"matteo_gz_github_io_i3hv4lcblw_articles",algoliaSearchKey:"e4b3657230aec6057242154527513ef1",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script src=/js/theme.min.js></script></body></html>